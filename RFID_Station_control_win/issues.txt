1) не отслеживается обновление списка команд при добавлении новых и запрос на получение деталей по ним не проходит. Асинхронщина
2) сделать буфер отправленных запросов и будер принятых ответов. Сопоставлять запросы и ответы по ID запроса, выставлять флаг готовности. Ждать ответа на запрос и удалять по тайм-ауту.